@use '../../styles/variables' as *;

/* Hybrid solution:
   - header is sticky (vertical)
   - body is horizontally scrollable
   - header scrollLeft is synced with body via JS
   This avoids the "sticky breaks because overflow-x container becomes the sticky ancestor". */
.amortization-table-shell {
  width: 100%;
}

.amortization-table-header {
  position: sticky;
  top: 0;
  z-index: 50;
  background: #1a1a1a; /* opaque */
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  /* reduce jitter */
  transform: translate3d(0, 0, 0);
}

/* Header scroll container: no user scrolling needed, just a viewport for the table */
.amortization-table-header-scroll {
  overflow: hidden;
}

/* Body scroll container: horizontal scroll lives here */
.amortization-table-body-scroll {
  overflow-x: auto;
  overflow-y: visible;
  -webkit-overflow-scrolling: touch;
}

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.amortization-table {
  width: 100%;
  border-collapse: separate; /* Esențial pentru sticky borders */
  border-spacing: 0;
  min-width: max-content; /* Permite tabelului să fie mai larg decât containerul */
  display: table; /* Keep table display for proper layout */

  th,
  td {
    white-space: nowrap; /* Previne ruperea textului care ar strica alinierea */
    padding: 12px 8px;
    text-align: center;
  }

  th {
    color: rgba(255, 255, 255, 0.85);
    font-weight: 600;
    font-size: 0.9rem;
  }

  td {
    color: rgba(255, 255, 255, 0.9);
    font-size: 0.9rem;
  }
}

/* Z-Index & Layers System:
   .sticky-col (prima coloană): z-index: 10
   header th: z-index: 20 (handled by sticky header container)
   corner: z-index: 30
*/

/* PRIMA COLOANĂ STICKY (Orizontal) - z-index: 10 (works inside body horizontal scroller) */
.amortization-table .sticky-col {
  position: -webkit-sticky; /* Safari support */
  position: sticky;
  left: 0;
  background-color: #1a1a1a !important; /* Opaque background - critical */
  z-index: 10; /* Base layer for sticky column */
  box-shadow: 2px 0 2px -1px rgba(0, 0, 0, 0.3);
  min-width: 100px;
}

/* COLȚUL (Intersecția între header și prima coloană) - z-index: 30 */
.amortization-table-header .amortization-table thead th.sticky-col {
  z-index: 30 !important; /* Highest z-index for corner cell */
  background-color: #1a1a1a !important; /* Opaque background - critical */
  padding-left: $spacing-xl;
  /* Prevent jitter on mobile - hardware acceleration */
  transform: translate3d(0, 0, 0);
  -webkit-transform: translate3d(0, 0, 0);
}

/* Design vizual pentru a separa coloana fixă */
.sticky-col::after {
  content: "";
  position: absolute;
  right: 0;
  top: 0;
  bottom: 0;
  width: 2px;
  background: linear-gradient(to right, rgba(0, 0, 0, 0.3), transparent);
  pointer-events: none;
}

/* Stiluri pentru rândurile de sumar (Total 2025 etc) */
.annual-summary-row {
  border-top: 2px solid #ccc;
  border-bottom: 2px solid #ccc;

  td {
    background-color: rgba(36, 36, 36, 0.8) !important;
    font-weight: bold;

    &:first-child {
      text-align: center;
    }
  }
}

/* Stiluri pentru rândurile plătite */
.was-payed {
  background-color: #1e3a2f;
  color: #d4edda;

  td {
    background-color: #1e3a2f;
    color: #d4edda;
  }
}
